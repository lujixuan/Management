<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ljx.dao.ProjectDao">
    <!-- 目的：为DAO接口方法提供sql语句配置 -->
    <!-- 查询用户和密码进行登录 -->
    <select id="listProject" resultType="com.ljx.dto.ProjectDto" >
		select  p.projectId,
			p.projectName,
			p.projectCode,
			p.projectDate,
			p.projectDescribe,
			pi.projectInfoUserId userId,
			u.userName
		from projects p
			join projectInfos pi on p.projectId=pi.projectInfoProjectId
			join users u on pi.projectInfoUserId = u.userId
		<where>
			<if test="loginUserId != null and loginUserId != ''">
				AND pi.projectInfoUserId = #{loginUserId}
			</if>
			<if test="projectName != null and projectName != ''">
				AND p.projectName = #{projectName}
			</if>
			<if test="projectCode != null and projectCode != ''">
				AND p.projectCode = #{projectCode}
			</if>
			<if test="userId != null and userId != ''">
				AND pi.projectInfoUserId = #{userId}
			</if>
			<if test="userName != null and userName != ''">
				AND u.userName = #{userName}
			</if>
			<if test="projectDate != null and projectDate != '' and projectToDate != null and projectToDate != ''">
				AND p.projectDate between #{projectDate} and #{projectToDate}
			</if>
		</where>
		AND pi.projectInfoType='创建人'
	</select>

	<select id="searchProjectDetail" resultType="com.ljx.dto.ProjectDto">
		select  p.projectId,
		p.projectName,
		p.projectCode,
		p.projectDate,
		p.projectDescribe,
		pi.projectInfoUserId userId,
		u.userName
		from projects p
		join projectInfos pi on p.projectId=pi.projectInfoProjectId
		join users u on pi.projectInfoUserId = u.userId
		<where>
			<if test="projectId != null and projectId != ''">
				AND p.projectId = #{projectId}
			</if>
		</where>
		AND pi.projectInfoType='创建人'
	</select>

    <!--&lt;!&ndash; 增加用户名和密码进行注册  &ndash;&gt;-->
    <!--<insert id="registerByUserId" parameterType="com.ljx.dto.UserDto">-->

 	    <!--insert into users (userId,userPwd,userName)-->
 	    <!--values-->
 	    <!--(#{userId},#{userPwd},#{userName})-->

 	<!--</insert>-->

</mapper>